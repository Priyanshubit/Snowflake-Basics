*** BASIC OPERATIONS ON DATABASE ***

USE DATABASE "DEMOBASE";


SELECT *
FROM OWNERS
WHERE OWNER_ID IN ( SELECT DISTINCT(OWNER_ID)
                    FROM PETS);

--- UNION ALL---
SELECT OWNER_ID, NAME
FROM OWNERS
UNION ALL
SELECT OWNER_ID, NAME
FROM PETS;

---EXCEPT CLAUSE---
SELECT OWNER_ID,NAME
FROM OWNERS
EXCEPT
SELECT OWNER_ID, NAME
FROM PETS;

---INTERSECT CLAUSE---
SELECT OWNER_ID,NAME
FROM OWNERS
INTERSECT
SELECT OWNER_ID, NAME
FROM PETS;


--- WAQ TO SHOW OWNERS NAME AND THEIR DOG NAME ALONG WITH THEIR AGE ---
SELECT O.NAME,P.NAME,P.AGE
FROM OWNERS O
JOIN PETS P 
ON O.OWNER_ID=P.OWNER_ID;


--- INNER JOIN IS FAST ---
SELECT O.Name AS OWNER_NAME, 
       P.Name AS PET_NAME, 
       P.age  AS PET_AGE
FROM OWNERS O
INNER JOIN PETS P
    ON O.OWNER_ID = P.OWNER_ID;

-- NAME OF ALL OWNERS IRRESPECTIVE WHETHER OR NOT THEY HAVE KIDS ---

SELECT O.NAME
FROM OWNERS O
LEFT JOIN PETS P
ON O.OWNER_ID=P.OWNER_ID

--- COUNT NUMBER OF PETS EACH OWNER HAS ---

SELECT O.NAME AS OWNER_NAME, COUNT(P.PET_ID) AS PETS_COUNT
FROM OWNERS O
JOIN PETS P 
ON O.OWNER_ID=P.OWNER_ID
GROUP BY O.NAME
ORDER BY COUNT(P.PET_ID) DESC

--- USING SUB QUERY ---
SELECT 
    O.NAME AS OWNER_NAME,
    (
        SELECT COUNT(*) 
        FROM PETS P
        WHERE P.OWNER_ID = O.OWNER_ID
    ) AS PET_COUNT
FROM OWNERS O
ORDER BY PET_COUNT DESC;


--- INFO OF ALL PETS HOLD BY THEIR OWNERS ---
SELECT O.NAME,P.PET_ID,P.NAME,P.KIND,P.GENDER,P.AGE
FROM OWNERS O
JOIN PETS P 
ON O.OWNER_ID=P.OWNER_ID
ORDER BY O.NAME




