
-- CREATE TABLE --


CREATE OR REPLACE TABLE EMPLOYEE
(
   EMPID INTEGER NOT NULL PRIMARY KEY,
   EMP_NAME VARCHAR2(20),
   JOB_ROLE STRING,
   SALARY NUMBER(10,2)
);

-- INSER INTO TABLE --

INSERT INTO EMPLOYEE
VALUES('101','ANAND JHA','Data Engineer',50000);

INSERT INTO EMPLOYEE
VALUES(102,'ALex', 'Data Engineer',60000);

INSERT INTO EMPLOYEE
VALUES(103,'Ravi', 'Data Scientist',48000);

INSERT INTO EMPLOYEE
VALUES(104,'Peter', 'Analyst',98000);

INSERT INTO EMPLOYEE
VALUES(105,'Pulkit', 'Data Scientist',72000);

INSERT INTO EMPLOYEE
VALUES(106,'Robert','Analyst',100000);

INSERT INTO EMPLOYEE
VALUES(107,'Rishabh','Data Engineer',67000);

INSERT INTO EMPLOYEE
VALUES(108,'Subhash','Manager',148000);

INSERT INTO EMPLOYEE
VALUES(109,'Michaeal','Manager',213000);

INSERT INTO EMPLOYEE
VALUES(110,'Dhruv','Data Scientist',89000);

INSERT INTO EMPLOYEE
VALUES(111,'Amit Sharma','Analyst',72000);



SELECT *
FROM EMPLOYEE;


-- UPDATE VALUES --

UPDATE EMPLOYEE
SET JOB_ROLE='Data Analyst'
WHERE EMPID=101;

UPDATE EMPLOYEE
SET SALARY=55000
WHERE EMPID=101;



------------ WINDOW FUNCTIONS ------------------
--- SYNTAX: WINDOW_FUNCTIONS_NAME(<EXPRESSION>) OVER(<PARTITION_BY CLAUSE> <ORDER_BY CLAUSE>) ---

--- DISPLAY TOTAL SALARY BASED ON JOB PROFILE ---
SELECT JOB_ROLE,SUM(SALARY) AS TOTAL_SALARY
FROM EMPLOYEE
GROUP BY 1
ORDER BY TOTAL_SALARY DESC;

--- DISPLAY TOTAL SALARY ALONG WITH ALL THE RECORDS(EVERY ROW VALUE) ---

SELECT *,
SUM(SALARY) OVER() AS TOTAL_SALARY 
FROM EMPLOYEE;

-- WHAT HAPPEN HERE IS, OVER CREATED A WINDOW OF TOTAL SALARY(FIXED FOR ALL) --



-- DISPLAY THE TOTAL SALARY PER JOB CATEG0RY FOR ALL THE ROWS ---

SELECT *,
SUM(SALARY) OVER(PARTITION BY JOB_ROLE) AS TOTAL_SALARY
FROM EMPLOYEE;

-- WHAT HAPPENED HERE IS, PARTITION BY JOB_ROLE CREATED A WINDOW WHERE THE SALARY IS ACCUMULATED AS PER JOB TITLE ---


-- DISPLAY THE MAX SALARY PER JOB CATEG0RY FOR ALL THE ROWS ---

SELECT *, 
MAX(SALARY) OVER(PARTITION BY JOB_ROLE) AS TOTAL_SALARY
FROM EMPLOYEE;

-- WHAT IS HAPPENED HERE IS, OVER CREATED A WINDOW WHERE IT IS SELCTION ONLY MAX SALARY BY EACH JOB ROLE ---
